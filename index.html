<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineBook - Movie Ticket Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- 
      NOTE: If you move this to a local environment, you can cut the content 
      of this <style> block and paste it into a file named 'style.css'. 
    -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-900 text-white font-sans min-h-screen flex flex-col">

    <!-- Header -->
    <header class="p-6 flex justify-between items-center bg-gray-900 border-b border-gray-800 sticky top-0 z-10">
        <div class="flex items-center gap-2">
            <i class="fas fa-film text-emerald-400 text-2xl"></i>
            <h1 class="text-2xl font-bold tracking-wider">Cine<span class="text-emerald-400">Book</span></h1>
        </div>
        <div class="text-sm text-gray-400 hidden sm:block">Select a movie, pick your seats, enjoy the show.</div>
    </header>

    <main class="flex-grow flex flex-col lg:flex-row h-full overflow-hidden">
        
        <!-- Sidebar: Movie Selection -->
        <div class="w-full lg:w-1/4 bg-gray-800/50 p-6 overflow-y-auto border-r border-gray-800 h-auto lg:h-[calc(100vh-80px)]">
            <h2 class="text-lg font-semibold mb-4 text-gray-300">Now Showing</h2>
            <div id="movie-list" class="space-y-4">
                <!-- Movies injected by JS -->
            </div>
        </div>

        <!-- Main Content: Theater & Booking -->
        <div class="w-full lg:w-3/4 flex flex-col relative overflow-y-auto h-[calc(100vh-80px)]">
            
            <!-- Movie Info Header -->
            <div class="p-6 pb-2 text-center lg:text-left">
                <h2 id="current-movie-title" class="text-3xl font-bold neon-text">Select a Movie</h2>
                <p id="current-movie-info" class="text-gray-400 mt-1 text-sm">Genre • Duration</p>
            </div>

            <!-- Legend -->
            <ul class="flex justify-center gap-6 mt-4 mb-2 text-xs text-gray-400">
                <li class="flex items-center gap-2">
                    <div class="seat cursor-default transform-none"></div> 
                    <span>Available</span>
                </li>
                <li class="flex items-center gap-2">
                    <div class="seat selected cursor-default transform-none"></div> 
                    <span>Selected</span>
                </li>
                <li class="flex items-center gap-2">
                    <div class="seat occupied cursor-default transform-none"></div> 
                    <span>Occupied</span>
                </li>
            </ul>

            <!-- Theater View -->
            <div class="theater-container flex-grow flex flex-col items-center justify-center p-8 overflow-x-auto">
                <div class="w-full max-w-lg mb-8">
                    <div class="screen w-full"></div>
                    <p class="text-center text-xs text-gray-500 mt-2">SCREEN</p>
                </div>
                
                <div id="seat-map" class="grid gap-x-4 gap-y-3 mx-auto">
                    <!-- Seats injected by JS -->
                </div>
            </div>

            <!-- Booking Bar (Bottom Fixed on Mobile) -->
            <div class="bg-gray-800 border-t border-gray-700 p-6 shadow-2xl z-20">
                <div class="max-w-4xl mx-auto flex flex-col sm:flex-row justify-between items-center gap-4">
                    <div class="text-center sm:text-left">
                        <p class="text-gray-400 text-sm">Tickets: <span id="count" class="text-emerald-400 font-bold text-lg">0</span></p>
                        <p class="text-gray-400 text-sm">Total: <span id="total" class="text-emerald-400 font-bold text-lg">$0</span></p>
                    </div>
                    <button onclick="openBookingModal()" id="book-btn" class="bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:-translate-y-1 hover:shadow-emerald-500/50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        Book Tickets
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Success Modal -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 hidden opacity-0 transition-opacity duration-300">
        <div class="bg-gray-800 border border-gray-700 p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center transform scale-90 transition-transform duration-300" id="modal-content">
            <div class="w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-check text-emerald-500 text-3xl"></i>
            </div>
            <h3 class="text-2xl font-bold text-white mb-2">Booking Confirmed!</h3>
            <p class="text-gray-400 text-sm mb-6">Enjoy the movie. Your tickets have been sent to your email.</p>
            
            <div class="bg-gray-900 rounded-lg p-4 mb-6 text-left border border-gray-700">
                <p class="text-xs text-gray-500 uppercase">Movie</p>
                <p id="modal-movie" class="font-bold text-white mb-2">Movie Name</p>
                <div class="flex justify-between">
                    <div>
                        <p class="text-xs text-gray-500 uppercase">Seats</p>
                        <p id="modal-seats" class="text-white">A1, A2</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-gray-500 uppercase">Price</p>
                        <p id="modal-price" class="text-emerald-400 font-bold">$24</p>
                    </div>
                </div>
            </div>

            <button onclick="closeModal()" class="w-full bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition">Close</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const movies = [
            { 
                id: 1, 
                title: "Interstellar Odyssey", 
                price: 12, 
                genre: "Sci-Fi • 2h 45m",
                image: "https://images.unsplash.com/photo-1534447677768-be436bb09401?auto=format&fit=crop&q=80&w=200",
                desc: "A journey through the stars to find a new home."
            },
            { 
                id: 2, 
                title: "The Laughing Detective", 
                price: 10, 
                genre: "Comedy • 1h 50m",
                image: "https://images.unsplash.com/photo-1509281373149-e957c6296406?auto=format&fit=crop&q=80&w=200",
                desc: "He solves crimes, but he can't stop laughing."
            },
            { 
                id: 3, 
                title: "Shadows of Tokyo", 
                price: 14, 
                genre: "Action • 2h 10m",
                image: "https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?auto=format&fit=crop&q=80&w=200",
                desc: "Neon lights hide the darkest secrets."
            },
            { 
                id: 4, 
                title: "Eternal Gardens", 
                price: 9, 
                genre: "Romance • 1h 40m",
                image: "https://images.unsplash.com/photo-1518173946687-a4c8892bbd9f?auto=format&fit=crop&q=80&w=200",
                desc: "Love blooms where you least expect it."
            }
        ];

        // --- STATE ---
        let selectedMovie = movies[0];
        let selectedSeats = [];
        // Simulating occupied seats for each movie
        const occupiedSeats = {
            1: [12, 13, 14, 45, 46],
            2: [1, 2, 3, 4, 34, 35],
            3: [22, 23, 50, 51, 52],
            4: [10, 20, 30]
        };

        const rows = 6;
        const seatsPerRow = 8;

        // --- DOM ELEMENTS ---
        const movieListEl = document.getElementById('movie-list');
        const movieTitleEl = document.getElementById('current-movie-title');
        const movieInfoEl = document.getElementById('current-movie-info');
        const seatMapEl = document.getElementById('seat-map');
        const countEl = document.getElementById('count');
        const totalEl = document.getElementById('total');
        const bookBtn = document.getElementById('book-btn');
        const modal = document.getElementById('modal');
        const modalContent = document.getElementById('modal-content');

        // --- INITIALIZATION ---
        function init() {
            renderMovies();
            loadMovie(selectedMovie);
        }

        // --- RENDER FUNCTIONS ---
        function renderMovies() {
            movieListEl.innerHTML = movies.map(movie => `
                <div onclick="selectMovie(${movie.id})" 
                     class="flex items-center gap-4 p-3 rounded-lg cursor-pointer transition hover:bg-gray-700 ${selectedMovie.id === movie.id ? 'bg-gray-700 border border-emerald-500/50' : ''}">
                    <img src="${movie.image}" class="w-12 h-16 object-cover rounded shadow-md" alt="${movie.title}">
                    <div>
                        <h3 class="font-bold text-sm ${selectedMovie.id === movie.id ? 'text-emerald-400' : 'text-white'}">${movie.title}</h3>
                        <p class="text-xs text-gray-400">$${movie.price}</p>
                    </div>
                </div>
            `).join('');
        }

        function loadMovie(movie) {
            selectedMovie = movie;
            selectedSeats = []; // Reset selection on movie change
            
            // Update UI Info
            movieTitleEl.textContent = movie.title;
            movieInfoEl.textContent = movie.genre;
            
            updateStats();
            renderMovies(); // Re-render list to update active state
            renderSeats();
        }

        function renderSeats() {
            seatMapEl.innerHTML = '';
            // Set grid columns dynamically
            seatMapEl.style.gridTemplateColumns = `repeat(${seatsPerRow}, min-content)`;

            const occupied = occupiedSeats[selectedMovie.id] || [];

            for (let i = 0; i < rows * seatsPerRow; i++) {
                const seat = document.createElement('div');
                const isOccupied = occupied.includes(i);
                
                seat.classList.add('seat');
                if (isOccupied) {
                    seat.classList.add('occupied');
                } else {
                    seat.addEventListener('click', () => toggleSeat(seat, i));
                }

                // Add VIP row styling (last 2 rows)
                if (i >= (rows - 2) * seatsPerRow) {
                   // seat.classList.add('vip'); // Optional visual cue
                }
                
                seatMapEl.appendChild(seat);
            }
        }

        // --- LOGIC ---
        function selectMovie(id) {
            const movie = movies.find(m => m.id === id);
            if (movie && movie.id !== selectedMovie.id) {
                loadMovie(movie);
            }
        }

        function toggleSeat(seatEl, index) {
            if (seatEl.classList.contains('occupied')) return;

            if (seatEl.classList.contains('selected')) {
                seatEl.classList.remove('selected');
                selectedSeats = selectedSeats.filter(id => id !== index);
            } else {
                seatEl.classList.add('selected');
                selectedSeats.push(index);
            }

            updateStats();
        }

        function updateStats() {
            const count = selectedSeats.length;
            const total = count * selectedMovie.price;

            countEl.textContent = count;
            totalEl.textContent = `$${total}`;
            
            bookBtn.disabled = count === 0;
            if (count > 0) {
                bookBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                bookBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        // --- MODAL ---
        window.openBookingModal = function() {
            if (selectedSeats.length === 0) return;

            // Populate Modal Data
            document.getElementById('modal-movie').textContent = selectedMovie.title;
            document.getElementById('modal-price').textContent = `$${selectedSeats.length * selectedMovie.price}`;
            
            // Convert seat index to readable format (e.g., A1, B3)
            const readableSeats = selectedSeats.map(i => {
                const row = String.fromCharCode(65 + Math.floor(i / seatsPerRow));
                const num = (i % seatsPerRow) + 1;
                return `${row}${num}`;
            }).join(', ');
            document.getElementById('modal-seats').textContent = readableSeats;

            modal.classList.remove('hidden');
            // Small timeout to allow display:block to apply before opacity transition
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modalContent.classList.remove('scale-90');
                modalContent.classList.add('scale-100');
            }, 10);
        };

        window.closeModal = function() {
            modal.classList.add('opacity-0');
            modalContent.classList.remove('scale-100');
            modalContent.classList.add('scale-90');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                // Reset after booking
                selectedSeats = [];
                // Add booked seats to occupied (temporary)
                if (!occupiedSeats[selectedMovie.id]) occupiedSeats[selectedMovie.id] = [];
                // occupiedSeats[selectedMovie.id].push(...selectedSeats); // Uncomment to persist in session
                
                renderSeats();
                updateStats();
            }, 300);
        };

        // Initialize App
        init();

    </script>
</body>
</html>